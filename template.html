<html>

<head> </head>

<body>
  <div id="main"></div>
  <script>
    window.addEventListener("load", (e) => {
      let timing = performance.getEntriesByType('navigation')[0];
      //请求发出到可以交互
      let tti = timing.domInteractive - timing.fetchStart;
    })
  </script>
  <script>
    //通过PerformanceObserver得到所有的longtask对象
    let observer = new PerformanceObserver(list => {
      for (const entry of list.getEntries()) {
        console.log(entry)
      }
    })
    //监听long tasks
    observer.observe({
      entryTypes: ['longtask']
    })
  </script>
  <script>
    //判断用户是否在看当前页面
    let vEvent = "visibilitychange";
    if (document.webkitHidden != undefined) {
      vEvent = "webkitvisibilitychange";
    }

    function visibilityChanged() {
      if (document.hidden || document.webkitHidden) {
        console.log('hidden')
      } else {
        console.log('show')
      }
    }
    document.addEventListener(vEvent, visibilityChanged, false);
  </script>
</body>

</html>